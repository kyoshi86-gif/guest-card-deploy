import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              */import{c as B,l as L,s as d}from"./base-BoAYqK8R.js";import"https://esm.sh/@supabase/supabase-js";B();document.getElementById("logout").onclick=L;const j=document.getElementById("gcForm"),c=document.getElementById("row_id"),p=document.getElementById("mediaLainnyaRadio"),y=document.getElementById("eventLainnyaRadio"),l=document.getElementById("media_other"),r=document.getElementById("event_other"),_=document.getElementById("btnSave"),f=document.getElementById("btnUpdate"),v=document.getElementById("btnDelete"),k=document.getElementById("btnCancel");document.getElementById("btnClose");const q=document.getElementById("btnReport"),b=document.getElementById("listBody");function s(t){return document.getElementById(t).value.trim()}function a(t){const e=document.querySelector(`input[name="${t}"]:checked`);return e?e.value:null}function o(t,e){if(!e)return;const n=document.querySelector(`input[name="${t}"][value="${e}"]`);n&&(n.checked=!0)}function w(){document.querySelectorAll('input[name="media_source"]').forEach(t=>{t.addEventListener("change",()=>{const e=p&&p.checked;l.disabled=!e,e||(l.value="")})}),document.querySelectorAll('input[name="event_type"]').forEach(t=>{t.addEventListener("change",()=>{const e=y&&y.checked;r.disabled=!e,e||(r.value="")})})}function u(){j.reset(),c.value="",l.disabled=!0,r.disabled=!0,_.disabled=!1,f.disabled=!0,v.disabled=!0}function E(){return{tgl:s("tgl"),jam:s("jam"),no_meja:s("no_meja"),nama_tamu:s("nama_tamu"),asal:a("asal"),media_source:a("media_source"),media_other:l.value.trim()||null,event_type:a("event_type"),event_other:r.value.trim()||null,age_range:a("age_range"),food_quality:parseInt(a("food_quality"))||null,beverage_quality:parseInt(a("beverage_quality"))||null,serving_speed:parseInt(a("serving_speed"))||null,service_rating:parseInt(a("service_rating"))||null,cleanliness:parseInt(a("cleanliness"))||null,ambience:parseInt(a("ambience"))||null,price_rating:parseInt(a("price_rating"))||null,comments:document.getElementById("comments").value.trim()||null}}function h(t){return!t.tgl||!t.jam||!t.no_meja||!t.nama_tamu?(alert("Mohon isi Tanggal, Jam, No Meja, dan Nama."),!1):!0}let g=[];async function m(){const{data:t,error:e}=await d.from("guest_comments").select("id,tgl,jam,no_meja,nama_tamu").order("tgl",{ascending:!1}).order("jam",{ascending:!1}).limit(500);if(e){console.error("Load error:",e.message);return}g=t||[],I(g)}function I(t){b.innerHTML="",t.forEach((e,n)=>{const i=document.createElement("tr");i.innerHTML=`
      <td>${n+1}</td>
      <td>${e.tgl??""}</td>
      <td>${e.jam??""}</td>
      <td>${e.no_meja??""}</td>
      <td>${e.nama_tamu??""}</td>`,i.addEventListener("click",()=>R(e.id)),b.appendChild(i)})}function C(){const t=document.getElementById("searchBox");t&&t.addEventListener("input",()=>{const e=t.value.toLowerCase(),n=g.filter(i=>(i.nama_tamu??"").toLowerCase().includes(e)||(i.no_meja??"").toLowerCase().includes(e)||(i.tgl??"").toLowerCase().includes(e));I(n)})}async function R(t){const{data:e,error:n}=await d.from("guest_comments").select("*").eq("id",t).single();if(n){alert("Gagal mengambil data: "+n.message);return}c.value=e.id,document.getElementById("tgl").value=e.tgl??"",document.getElementById("jam").value=(e.jam??"").toString().substring(0,5),document.getElementById("no_meja").value=e.no_meja??"",document.getElementById("nama_tamu").value=e.nama_tamu??"",o("asal",e.asal),o("media_source",e.media_source),o("event_type",e.event_type),o("age_range",e.age_range),e.media_source==="Lainnya"&&(l.disabled=!1,l.value=e.media_other??""),e.event_type==="Lainnya"&&(r.disabled=!1,r.value=e.event_other??""),o("food_quality",e.food_quality),o("beverage_quality",e.beverage_quality),o("serving_speed",e.serving_speed),o("service_rating",e.service_rating),o("cleanliness",e.cleanliness),o("ambience",e.ambience),o("price_rating",e.price_rating),document.getElementById("comments").value=e.comments??"",_.disabled=!0,f.disabled=!1,v.disabled=!1}async function S(){const t=E();if(!h(t))return;delete t.id;const{error:e}=await d.from("guest_comments").insert([t]);if(e){alert("Gagal simpan: "+e.message);return}alert("Data tersimpan."),u(),m()}async function D(){const t=c.value;if(!t){alert("Pilih data pada tabel (kanan) untuk di-update.");return}const e=E();if(!h(e))return;const{error:n}=await d.from("guest_comments").update(e).eq("id",t);if(n){alert("Gagal update: "+n.message);return}alert("Data berhasil diupdate."),u(),m()}async function $(){const t=c.value;if(!t){alert("Pilih data pada tabel (kanan) untuk dihapus.");return}if(!confirm("Yakin hapus data ini?"))return;const{error:e}=await d.from("guest_comments").delete().eq("id",t);if(e){alert("Gagal hapus: "+e.message);return}alert("Data dihapus."),u(),m()}function M(){u()}function T(){window.open("report.html")}document.addEventListener("DOMContentLoaded",()=>{w(),m(),C(),_.addEventListener("click",S),f.addEventListener("click",D),v.addEventListener("click",$),k.addEventListener("click",M),q.addEventListener("click",T)});
