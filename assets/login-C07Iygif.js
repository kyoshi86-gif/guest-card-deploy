import"./modulepreload-polyfill-B5Qt9EMX.js";const{createClient:l}=supabase,c="https://drdflrzsvfakdnhqniaa.supabase.co",d="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRyZGZscnpzdmZha2RuaHFuaWFhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU1ODY5MDAsImV4cCI6MjA3MTE2MjkwMH0.I88GG5xoPsO0h5oXBxPt58rfuxIqNp7zQS7jvexXss8",i=l(c,d);document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("btnLogin");e.addEventListener("click",u),document.addEventListener("keydown",t=>{t.key==="Enter"&&(t.preventDefault(),e.click())})});async function u(){const e=document.getElementById("email").value,t=document.getElementById("password").value,o=document.getElementById("error-msg");console.log("Trying login with:",e);const{data:n,error:r}=await i.auth.signInWithPassword({email:e,password:t});if(r){console.error("Login error:",r),o.textContent="Login gagal: "+r.message;return}console.log("Login success:",n);const{data:a,error:s}=await i.from("user_roles").select("role").eq("user_id",n.user.id).maybeSingle();if(s){console.error("Role fetch error:",s),o.textContent="Gagal ambil role: "+s.message;return}if(!a){o.textContent="User belum punya role di tabel user_roles";return}localStorage.setItem("supabase.auth.token",JSON.stringify(n.session)),localStorage.setItem("user_role",a.role),window.location.href="index.html"}
